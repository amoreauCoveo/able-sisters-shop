<!doctype html>

    <html lang="en">
    
    <head>
        <meta charset="utf-8">
    
        <title>Racing Helmet</title>
        <meta name="description" content="Racing Helmet">
        <meta name="sku" content="racinghelmet">
        <script src="https://static.cloud.coveo.com/searchui/v2.10095/js/CoveoJsSearch.Lazy.min.js"></script>
        <script src="https://static.cloud.coveo.com/searchui/v2.10095/js/templates/templates.js"></script>
        <script src="https://static.goqubit.com/smartserve-6051.js"></script>
        <script defer>
            var qubitproduct = {};
            document.addEventListener("DOMContentLoaded", async () => {
                await window["uv"].emit('ecView', {
                    type: 'product',
                    subtypes: ['helmets', 'Outdoorsy;Sporty;Work', 'Black', 'White'],
                    language: 'en-us',
                    country: 'Canada',
                    currency: 'CAD'
                })
    
                qubitproduct = {
                    productId: 'racinghelmet',
                    sku: 'FNxEraBTeWRiCvtFu',
                    name: 'Racing Helmet',
                    categories: ['helmets'],
                    price: {
                        value: 1040.0,
                        currency: 'CAD'
                    },
                    originalPrice: {
                        value: 1040.0,
                        currency: 'CAD'
                    },
                    url: 'https://able-sisters-shop.vercel.app/helmets/racinghelmet-6hzfbtRroRgefZL9u.html',
                    images: ['https://acnhcdn.com/latest/ClosetIcon/CapFullfaceRacing2.png'],
                    color: 'Black',
                    description: '',
                };
                await window["uv"].emit('ecProduct', {
                    product: qubitproduct,
                    eventType: 'detail'
                })

                const qcart = localStorage.getItem("qcart");
                if (qcart) {
                    JSON.parse(qcart).forEach(item => {
                        window["uv"].emit('ecBasketItem', returnFullBasketItem(item))   
                    })
                    const cartTotalPrice = getCartTotal();
                    window["uv"].emit('ecBasketSummary', {
                        basket: {
                            subtotal: {
                                value: cartTotalPrice,
                                currency: 'CAD'
                            },
                            total: {
                                value: cartTotalPrice,
                                currency: 'CAD'
                            },
                            quantity: getCartNumberItems(),
                            subtotalIncludingTax: {
                                value: cartTotalPrice,
                                currency: 'CAD'
                            }
                        }
                    })
                }
            })
        </script>
        <script>
        document.addEventListener("DOMContentLoaded", () => {
            const root = document.querySelector('#relatedproducts');
            const searchboxroot = document.querySelector("#searchbox");
            const recRoot = document.querySelector('#recommendations');
            Coveo.SearchEndpoint.configureCloudV2Endpoint(
                "amoreautests2frw2xc0",
                "xxa4407c2a-e7f9-44c6-998c-7d657c4398ba",
                "https://platform.cloud.coveo.com/rest/search",
                {
                  "queryStringArguments": {
                    "mlParameters": '{"itemId": "6hzfbtRroRgefZL9u"}',
                    "recommendation": "FrequentlyViewed",
                    "numberOfResults": 5
                  }
                }
            );
            Coveo.init(root);
            Coveo.init(recRoot);
            Coveo.initSearchbox(searchboxroot, "../search.html");
            
            Coveo.$$(root).on("doneBuildingQuery", function (e, args) {
                args.queryBuilder.advancedExpression.add("@ec_item_group_id==\"racinghelmet\" NOT @uniqueid=6hzfbtRroRgefZL9u")
            })

            Coveo.$$(root).on("querySuccess", function (e, args) {
                args.results.results.forEach(result => {
                    const product = result.raw;
                    console.log(result.raw);
                    const categories = [];
                    categories.push(product['ec_category'])
                    const images = [];
                    images.push(product['thumbnailurl']);
                    window["uv"].emit('ecProduct', {
                        product: {
                            productId: product['ec_productid'],
                            sku: product['permanentid'],
                            name: product['ec_name'],
                            categories: categories,
                            price: {
                                value: product['ec_price'],
                                currency: 'CAD'
                            },
                            originalPrice: {
                                value: product['ec_price'],
                                currency: 'CAD'
                            },
                            url: result.uri,
                            images: images,
                            color: product['cat_color'][0],
                            description: '',
                        },
                        eventType: 'detail'
                    })
                });
            });

            Coveo.$$(recRoot).on("querySuccess", function (e, args) {
                args.results.results.forEach(result => {
                    const product = result.raw;
                    console.log(result.raw);
                    const categories = [];
                    categories.push(product['ec_category'])
                    const images = [];
                    images.push(product['thumbnailurl']);
                    window["uv"].emit('ecProduct', {
                        product: {
                            productId: product['ec_productid'],
                            sku: product['permanentid'],
                            name: product['ec_name'],
                            categories: categories,
                            price: {
                                value: product['ec_price'],
                                currency: 'CAD'
                            },
                            originalPrice: {
                                value: product['ec_price'],
                                currency: 'CAD'
                            },
                            url: result.uri,
                            images: images,
                            color: product['cat_color'][0],
                            description: '',
                        },
                        eventType: 'detail'
                    })
                });
            });

            document.querySelector("#addToCartButton").addEventListener("click", function (){
                const itemtoaddtocart = {"sku": "6hzfbtRroRgefZL9u", "price": 1040.0, "name": "Racing Helmet", "category": "Helmets", "image": "https://acnhcdn.com/latest/ClosetIcon/CapFullfaceRacing2.png"};
                addtocart(itemtoaddtocart, qubitproduct);
                window["uv"].emit('ecBasketItemAction', {
                    product: {
                        productId: 'racinghelmet',
                        sku: '6hzfbtRroRgefZL9u'
                    },
                    action: 'add',
                    quantity: 1
                })
                const cartTotalPrice = getCartTotal();
                window["uv"].emit('ecBasketSummary', {
                    basket: {
                        subtotal: {
                            value: cartTotalPrice,
                            currency: 'CAD'
                        },
                        total: {
                            value: cartTotalPrice,
                            currency: 'CAD'
                        },
                        quantity: getCartNumberItems(),
                        subtotalIncludingTax: {
                            value: cartTotalPrice,
                            currency: 'CAD'
                        }
                    }
                })
            })
        });
    </script>
        <link rel="stylesheet" href="../src/style.css" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10095/css/CoveoFullSearch.min.css" />
        <script src="../src/scripts.js"></script>
        <script>
            (function(c,o,v,e,O,u,a){
            a='coveoua';c[a]=c[a]||function(){(c[a].q=c[a].q|| []).push(arguments)};
            c[a].t=Date.now();u=o.createElement(v);u.async=1;u.src=e;
            O=o.getElementsByTagName(v)[0];O.parentNode.insertBefore(u,O)
            })(window,document,'script','https://static.cloud.coveo.com/coveo.analytics.js/2/coveoua.js')
            coveoua('set', 'currencyCode', "Bell");
            // When using an API key instead of a search token, add the following lines of code
            /*
            if (typeof "<USER_ID>" !== 'undefined') {
              coveoua('set', 'userId', "<USER_ID>");
            }
            */
            // end
            coveoua('init', "xxe96351e4-1aac-40f8-b59e-43ea4545936d", "https://analytics.cloud.coveo.com/rest/ua");
            coveoua('ec:addProduct', {
                'id':"6hzfbtRroRgefZL9u",
                'name': "Racing Helmet",
                'category': "Helmets",
                'price': 1040.0,
                'position': 1
            })
            coveoua('ec:setAction', 'detail');
            coveoua('send', 'event')
            </script>
    </head>
    <body>
    <header>
        <div class="header">
            <div class="header-title">
                <a href="../index.html">Able Sisters Shop</a>
            </div>
        <div class="cart">
            <a href="../cart.html">Cart</a>
        </div>
    </div>
        <div id="searchbox">
            <div class="CoveoSearchbox"></div>
            <div class="CoveoAnalytics" data-search-hub="ablesisters search"></div>
        </div>
        <div id="nav">
        <div class="nav-button" id="accessories">
            <a href="../accessory.html">Accessories</a>
        </div>
        <div class="nav-button" id="hats">
            <a href="../hats.html">Hats</a>
        </div>
        <div class="nav-button" id="helmets">
            <a href="../helmets.html">Helmets</a>
        </div>
        <div class="nav-button" id="tops">
            <a href="../top.html">Tops</a>
        </div>
    </div>
    </header>
        <h1>Racing Helmet</h1>
        <img src="https://acnhcdn.com/latest/ClosetIcon/CapFullfaceRacing2.png"/>
    <div>
        <span>Also available in:</span>
        <div class="alternate-colors">
            <div class="CoveoSearchInterface" id="relatedproducts">
                <div class="CoveoAnalytics" data-search-hub="AbleSisters Individual Listing"></div>
                <div class="CoveoResultList" data-layout="card" data-wait-animation="fade" data-auto-select-fields-to-include="false"
                data-fields-to-include="@thumbnailurl, @cat_color, @ec_category, @ec_productid, @ec_name, @ec_price, @ec_style, @permanentid">
                    <script id="relatedproducts" class="result-template" type="text/html" data-layout="card">
                        <a class="CoveoResultLink">
                            <div>
                                <span class="CoveoFieldValue" data-field="@thumbnailurl" data-helper="image" data-html-value="true" data-helper-options-width="100"></span>
                            </div>
                            <div class="CoveoFieldValue" data-field="@cat_color"></div>
                        </a>
                      </script>
                </div>
            </div>
        </div>
    </div>
        <table>
            <tr>
                <td>Price</td>
                <td>1040.0 Bells</td>
            </tr>
            <tr>
                <td>Style</td>
                <td>Cool</td>
            </tr>
            <tr>
                <td>Themes</td>
                <td>Outdoorsy,Sporty,Work</td>
            </tr>
        </table>
        <button class="add-to-cart-button" id="addToCartButton">Add to cart</button>
        <div>People also viewed:</div>
        <div id="recommendations" class="CoveoRecommendations" data-pipeline="AbleSistersCartRec">
            <div class="CoveoAnalytics" data-search-hub="ablesisters rec"></div>
            <div class="coveo-recommendation-body">
                <div class="CoveoResultList" data-layout="card" data-auto-select-fields-to-include="false"
                data-fields-to-include="@thumbnailurl, @cat_color, @ec_category, @ec_productid, @ec_name, @ec_price, @ec_style, @permanentid">
                    <script id="Default" class="result-template" type="text/html" data-layout="card">
                        <div class="coveo-result-frame">
                            <div class="coveo-result-cell">
                                <div class="coveo-result-row">
                                    <span class="CoveoResultLink">
                                        <span class="CoveoFieldValue" data-field="@thumbnailurl" data-helper="image" data-html-value="true" data-helper-options-width="200"></span>
                                    </span>
                                </div>
                                <div class="coveo-result-row">
                                  <a class="CoveoResultLink"></a>
                                </div>
                                <div class="coveo-result-row">
                                  <span class="CoveoFieldValue" data-field="@ec_price"></span> Bells
                                </div>
                                <div class="coveo-result-row">
                                  <div class="coveo-result-cell">
                                    <span class="CoveoResultFolding" data-result-template-id="relatedproducts"></span>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </script>
                </div>
            </div>
        </div>
    </body>
    
    </html>